function getID(){var o=window.location.href;return o.substring(o.lastIndexOf("/")+1)}function loadResume(o,t){$("[data='product-value']").text("R$ "+o.price.toFixed(2)),$("[data='shippment-value']").text("R$ "+t.shippingPrice.toFixed(2))}function getTotal(o){$("[data='total-value']").text("R$ "+o.totalPrice)}function getCurrency(o){return Number(o.replace(/[^0-9.-]+/g,""))}function loadCoupons(o){for(var t=0;t<o.length;t++)$("[data='coupons-list']").append("<label data='coupon' class='checkbox__container'><div class='coupon'><span>"+o[t].title+"</span><span data='coupon-discont' class='coupon__discount'>- R$ "+o[t].discount.toFixed(2)+"</span></div><input data='coupon-id' type='radio' name='radio' value='"+o[t].id+"' /><span class='checkbox__checkmark' ></span></label>")}function selectCoupon(o){showCoupon(o);var t=$(o).find("[data='coupon-id']").val();baseUrl=baseUrl+"?couponId="+t,jQuery.get(baseUrl,function(o){getTotal(o.checkout)})}function showCoupon(o){var t=$(o).find("[data='coupon-discont']").text();$("[data='coupon-value']").text(t),$("[data='selected-coupon']").show()}function hideCoupon(){$("[data='coupon-value']").text("R$ 00.00"),$("[data='selected-coupon']").hide(),baseUrl="/api/checkouts/"+getID(),jQuery.get(baseUrl,function(o){getTotal(o.checkout)})}function showModal(o){img="/img/cart.png",title="compra confirmada",text="enviaremos atualizações sobre o pedido para o seu email",o&&"cancel"==o?(img="/img/cart-red.png",title="compra cancelada",text="o pedido não foi enviador e você não será cobrado"):o&&"error"==o&&(img="/img/cart-red.png",title="algo deu errado",text="por favor, tente novamente mais tarde"),$("[data='modal-image']").prop("src",img),$("[data='modal-title']").text(title),$("[data='modal-text']").text(text),$("[data='modal']").show()}function hideModal(){$("[data='modal']").hide()}var baseUrl="/api/checkouts/"+getID(),clicked=0;jQuery.get(baseUrl,function(o){$("[data='product-image']").prop("src",o.product.image),loadCoupons(o.checkout.availableCoupons),loadResume(o.product,o.checkout),getTotal(o.checkout)}),jQuery(document).ready(function(){jQuery("[data='coupon']").click(function(){"none"!=$("input[name='radio']:checked").val()&&0==clicked&&(selectCoupon(this),clicked=1)})}),jQuery("[data='unselect-coupon']").click(function(){clicked=0,hideCoupon()}),jQuery("[data='cancel-button']").click(function(){showModal("cancel")}),jQuery("[data='confirm-button']").click(function(){jQuery.post(baseUrl,function(o){"success"==o.status?showModal():showModal("error")})}),jQuery("[data='modal']").click(function(){hideModal()});